% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calculatePRS.R
\name{calculatePRSref}
\alias{calculatePRSref}
\title{Calculate PRS for REF Allele Matches}
\usage{
calculatePRSref(
  ref_matches,
  prssnps,
  vcf_summary,
  batch_size = 1000,
  verbose = FALSE
)
}
\arguments{
\item{ref_matches}{List where each element is a vector containing the prssnps index followed by matching vcfsnpinfo indices (position and REF match)}

\item{prssnps}{Data frame with PRS SNP information containing columns:
\itemize{
\item rsID: SNP identifier
\item chr_position: Chromosome position
\item effect_weight: Effect weight for PRS calculation
\item effect_allele: Effect allele
}}

\item{vcf_summary}{List returned from summarizevcf() function containing vcf_file, genome, snp_summary, and sample_ids}

\item{batch_size}{Integer; maximum number of SNPs to read from VCF at once. Default is 1000.}

\item{verbose}{Logical; if TRUE, display informational messages during execution. Default is FALSE.}
}
\value{
A numeric vector of PRS values for all samples
}
\description{
Calculate PRS for REF Allele Matches
}
\details{
For REF matches, the VCF dosage represents the non-effect (alternate) allele dosage.
The effect allele dosage is calculated as (2 - dosage_sum), then multiplied by the effect weight.
}
\examples{
\dontrun{
vcf_file <- "data/axiom_acs_aus_nf_chr21.vcf.gz"
vcf_summary <- summarizevcf(vcf_file)
snp_matches <- findSNPs(prssnps, vcf_summary$snp_summary$snp_df)
prs_ref <- calculatePRSref(snp_matches$ref_matches, prssnps, vcf_summary)
}
}
