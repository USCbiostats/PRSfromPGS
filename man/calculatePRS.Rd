% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calculatePRS.R
\name{calculatePRS}
\alias{calculatePRS}
\title{Calculate Polygenic Risk Score Across Chromosomes}
\usage{
calculatePRS(
  pgsmodel,
  chromosomes = 1:22,
  vcf_dir = ".",
  batch_size = 1000,
  parallel = FALSE,
  n_cores = NULL,
  verbose = TRUE
)
}
\arguments{
\item{pgsmodel}{Data frame returned from readPGSmodel() containing PGS variant information.
Expected columns: rsID, chr_name, chr_position, effect_allele, other_allele, effect_weight}

\item{chromosomes}{Integer vector of chromosome numbers to process. Default is 1:22 (autosomes).}

\item{vcf_dir}{Character string specifying directory containing VCF summary files. Default is "." (current directory).}

\item{batch_size}{Integer; maximum number of SNPs to read from VCF at once. Default is 1000.}

\item{parallel}{Logical; if TRUE, process chromosomes in parallel using future. Default is FALSE.}

\item{n_cores}{Integer; number of cores to use for parallel processing. Default is NULL (use all available).}

\item{verbose}{Logical; if TRUE (default), display informational messages during execution}
}
\value{
A list containing:
\itemize{
\item prs: A numeric vector of PRS values for all samples
\item unmatched_by_chr: A named vector with counts of unmatched SNPs by chromosome
\item unmatched_rsIDs: A named list with rsIDs of unmatched SNPs by chromosome
\item excluded_chr_counts: A named vector with counts of SNPs not on processed chromosomes
}
}
\description{
Calculates PRS by processing variants from multiple chromosomes. For each chromosome,
the function loads VCF summary data, matches variants, and calculates PRS contributions
from both REF and ALT allele matches. The final PRS is the sum across all chromosomes.
}
\examples{
\dontrun{
# Read PGS model
pgs_model <- readPGSmodel("pgsmodel.txt")

# Calculate PRS for all autosomes
result <- calculatePRS(pgs_model)
prs_values <- result$prs
unmatched_counts <- result$unmatched_by_chr
unmatched_ids <- result$unmatched_rsIDs
excluded_counts <- result$excluded_chr_counts

# View unmatched SNPs for chromosome 1
result$unmatched_rsIDs[["1"]]

# View SNPs on non-autosomal chromosomes (X, Y, MT, etc.)
result$excluded_chr_counts

# Calculate PRS for specific chromosomes
result <- calculatePRS(pgs_model, chromosomes = c(1, 2, 3))

# Calculate PRS quietly
result <- calculatePRS(pgs_model, verbose = FALSE)

# Calculate PRS with custom batch size
result <- calculatePRS(pgs_model, batch_size = 500)

# Calculate PRS in parallel
result <- calculatePRS(pgs_model, parallel = TRUE)

# Calculate PRS in parallel with specific number of cores
result <- calculatePRS(pgs_model, parallel = TRUE, n_cores = 4)

# Calculate PRS using VCF summaries from a specific directory
result <- calculatePRS(pgs_model, vcf_dir = "vcf_summaries")
}
}
