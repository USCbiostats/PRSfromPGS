% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calculatePRS.R
\name{fitPRSmodels}
\alias{fitPRSmodels}
\title{Fit Multiple PRS Models Efficiently}
\usage{
fitPRSmodels(
  model_files,
  chromosomes = seq_len(22),
  vcf_dir = ".",
  batch_size = 1000,
  parallel = FALSE,
  n_cores = NULL,
  verbose = TRUE
)
}
\arguments{
\item{model_files}{Character vector of file paths to PGS model files}

\item{chromosomes}{Integer vector of chromosome numbers to process. Default is seq_len(22) (autosomes).}

\item{vcf_dir}{Character string specifying directory containing VCF summary files. Default is "." (current directory).}

\item{batch_size}{Integer; maximum number of SNPs to read from VCF at once. Default is 1000.}

\item{parallel}{Logical; if TRUE, process chromosomes in parallel using future. Default is FALSE.}

\item{n_cores}{Integer; number of cores to use for parallel processing. Default is NULL (use all available).}

\item{verbose}{Logical; if TRUE (default), display informational messages during execution}
}
\value{
A list containing:
\itemize{
\item prs: A matrix where rows are samples and columns are models (named after model files)
\item unmatched_by_chr: A named list where each entry corresponds to a model and contains
a named vector with counts of unmatched SNPs by chromosome
\item unmatched_rsIDs: A named list where each entry corresponds to a model and contains
a named list with rsIDs of unmatched SNPs by chromosome
\item excluded_chr_counts: A named list where each entry corresponds to a model and contains
a named vector with counts of SNPs not on processed chromosomes
}
}
\description{
Calculates PRS for multiple models by reading each chromosome's VCF data only once.
This is much more efficient than calling calculatePRS() separately for each model.
}
\examples{
\dontrun{
# Fit multiple PRS models
model_files <- c("model1.txt", "model2.txt", "model3.txt")
results <- fitPRSmodels(model_files)
prs_matrix <- results$prs  # Rows = samples, columns = models

# Access results for a specific model
model1_prs <- results$prs[, "model1.txt"]
model1_unmatched <- results$unmatched_by_chr[["model1.txt"]]

# Fit models for specific chromosomes
results <- fitPRSmodels(model_files, chromosomes = c(1, 2, 3))

# Fit models quietly
results <- fitPRSmodels(model_files, verbose = FALSE)

# Fit models with custom batch size
results <- fitPRSmodels(model_files, batch_size = 500)

# Fit models in parallel
results <- fitPRSmodels(model_files, parallel = TRUE)

# Fit models in parallel with specific number of cores
results <- fitPRSmodels(model_files, parallel = TRUE, n_cores = 4)

# Fit models using VCF summaries from a specific directory
results <- fitPRSmodels(model_files, vcf_dir = "vcf_summaries")
}
}
